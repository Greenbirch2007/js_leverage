


import datetime
import time

import pymysql
import requests
from lxml import etree
import json
from queue import Queue
import threading
from requests.exceptions import RequestException




from retrying import retry

def retry_if_io_error(exception):
    return isinstance(exception, ZeroDivisionError)







def run_forever(func):
    def wrapper(obj):
        while True:
            func(obj)
    return wrapper


def RemoveDot(item):
    f_l = []
    for it in item:

        f_str = "".join(it.split(","))
        ff_str = f_str +"00"
        f_l.append(ff_str)

    return f_l

def remove_douhao(num):
    num1 = "".join(num.split(","))
    f_num = str(num1)
    return f_num
def remove_block(items):
    new_items = []
    for it in items:
        f = "".join(it.split())
        new_items.append(f)
    return new_items
def call_page(url):
    try:
        response = requests.get(url)
        if response.status_code == 200:
            return response.text
        return None
    except RequestException:
        return None


class JSPool_M(object):

    def __init__(self,url):
        self.url = url

    def page_request(self):
        ''' 发送请求获取数据 '''
        headers = {
            'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36'
        }

        response = requests.get(self.url,headers=headers)
        if response.status_code == 200:
            html = response.text
            return html
        else:
            pass

    def page_parse_(self):
        '''根据页面内容使用lxml解析数据, 获取段子列表'''


        html  = self.page_request()
        element = etree.HTML(html)

        now_price = element.xpath(
            '//*[@id="layout"]/div[2]/div[3]/div[2]/div/div[1]/div/div/div[1]/div[2]/div/div[2]/div/text()')
        f_price = RemoveDot(remove_block(now_price))
        big_list.append(float(f_price[0]))
        print(f_price[0])
        return big_list







def compare_insertDB(big_list,f_compare_content,base_dt_list,tablename):
    ff_l = []

    index225_ = (big_list[0] - base_dt_list[0]) / base_dt_list[0]
    index400_ = (big_list[1] - base_dt_list[1]) / base_dt_list[1]

    f_compare_content.append(str(round(index225_,5)))
    f_compare_content.append(str(round(index400_,5)))

    for i1,i2 in zip(big_list[2:],base_dt_list[2:]):
        if (((i1-i2)/i2)-0.03) > max(float(f_compare_content[0]),float(f_compare_content[1])):
            print((i1-float(i2))/float(i2)-0.05)
            print(max(index225_,index400_))

            f_compare_content.append(round(((i1-i2)/i2),5))
        else:
            print(round(((i1-float(i2))/float(i2))))
            f_compare_content.append("null")


    f_tup = tuple(f_compare_content)
    print(f_tup)
    ff_l.append((f_tup))
    print(ff_l)
    print(big_list)
    print(f_compare_content)
    connection = pymysql.connect(host='127.0.0.1', port=3306, user='root', password='123456', db='JS',
                                 charset='utf8mb4', cursorclass=pymysql.cursors.DictCursor)

    cursor = connection.cursor()

    try:
        # 用一个列表解析
        f_jsp = ["J" + cod for cod in into_db]
        sp_func = lambda x: ",".join(x)
        f_lcode = sp_func(f_jsp)

        f_ls = "%s," * len(into_db)
        fc = f_lcode
        print(len(fc.split(",")))
        print(len(f_ls[:-1].split(",")))
        cursor.executemany('insert into {2} ({0}) values ({1})'.format(fc, f_ls[:-1],tablename), ff_l)
        connection.commit()
        connection.commit()
        connection.close()
        print('向MySQL中添加数据成功！')
    except TypeError:
        pass
    e = datetime.datetime.now()
    print(e-s)




def get_index():
    index_code = ["0000", "0040"]
    for i_code in index_code:
        url ='https://kabutan.jp/stock/?code={0}'.format(i_code)
        html =call_page(url)
        element = etree.HTML(html)

        now_price = element.xpath('//*[@id="stockinfo_i1"]/div[2]/span[2]/text()')
        f_price = RemoveDot(remove_block(now_price))
        big_list.append(float(f_price[0]))




if __name__ == "__main__":
    s = datetime.datetime.now()
    into_db =  ["225","400",'1332','1333', '1417', '1605', '1719', '1720', '1721', '1766', '1801', '1802', '1803', '1808',
                       '1812', '1820', '1821', '1824', '1860', '1861', '1878', '1881', '1893', '1911', '1925', '1928',
                       '1942', '1951', '1959', '1963', '1973', '2002', '2121', '2127', '2146', '2175', '2181', '2201',
                       '2229', '2264', '2267', '2269', '2281', '2282', '2317', '2327', '2331', '2337', '2371', '2379',
                       '2412', '2413', '2427', '2432', '2433', '2501', '2502', '2503', '2531', '2587', '2593', '2651',
                       '2670', '2702', '2768', '2782', '2784', '2801', '2802', '2809', '2811', '2815', '2871', '2875',
                       '2897', '2914', '3003', '3038', '3048', '3064', '3086', '3088', '3092', '3099', '3101', '3103',
                       '3107', '3116', '3141', '3148', '3167', '3231', '3244', '3254', '3288', '3289', '3291', '3349',
                       '3360', '3382', '3391', '3401', '3402', '3405', '3407', '3436', '3543', '3549', '3563', '3626',
                       '3635', '3659', '3738', '3765', '3769', '3861', '3863', '3880', '3923', '3932', '3941', '4004',
                       '4005', '4021', '4042', '4043', '4061', '4063', '4088', '4091', '4151', '4182', '4183', '4188',
                       '4202', '4204', '4205', '4206', '4208', '4307', '4324', '4348', '4403', '4452', '4502', '4503',
                       '4506', '4507', '4516', '4519', '4521', '4523', '4527', '4528', '4536', '4543', '4552', '4553',
                       '4568', '4578', '4587', '4612', '4613', '4631', '4661', '4684', '4686', '4689', '4704', '4716',
                       '4732', '4739', '4751', '4755', '4768', '4812', '4816', '4819', '4848', '4849', '4887', '4901',
                       '4902', '4911', '4912', '4921', '4922', '4927', '4967', '5019', '5020', '5021', '5101', '5105',
                       '5108', '5110', '5201', '5202', '5214', '5232', '5233', '5301', '5332', '5333', '5334', '5393',
                       '5401', '5406', '5411', '5541', '5631', '5703', '5706', '5707', '5711', '5713', '5714', '5801',
                       '5802', '5803', '5857', '5929', '5947', '6005', '6028', '6035', '6055', '6098', '6103', '6113',
                       '6134', '6136', '6141', '6146', '6178', '6183', '6201', '6235', '6268', '6273', '6301', '6302',
                       '6305', '6326', '6361', '6367', '6383', '6432', '6448', '6465', '6471', '6472', '6473', '6479',
                       '6501', '6503', '6504', '6506', '6532', '6544', '6586', '6594', '6645', '6670', '6674', '6701',
                       '6702', '6703', '6723', '6724', '6727', '6728', '6750', '6752', '6753', '6754', '6758', '6762',
                       '6770', '6841', '6845', '6849', '6856', '6857', '6861', '6869', '6902', '6920', '6923', '6952',
                       '6954', '6965', '6971', '6976', '6981', '6988', '7003', '7004', '7011', '7012', '7013', '7148',
                       '7164', '7167', '7177', '7186', '7201', '7202', '7203', '7205', '7211', '7259', '7261', '7267',
                       '7269', '7270', '7272', '7276', '7282', '7309', '7313', '7419', '7453', '7459', '7516', '7532',
                       '7550', '7564', '7575', '7649', '7701', '7717', '7729', '7731', '7733', '7735', '7741', '7747',
                       '7751', '7752', '7762', '7832', '7846', '7911', '7912', '7947', '7951', '7956', '7974', '7988',
                       '8001', '8002', '8015', '8020', '8031', '8035', '8053', '8056', '8058', '8088', '8111', '8113',
                       '8194', '8233', '8252', '8253', '8267', '8273', '8279', '8282', '8283', '8303', '8304', '8306',
                       '8308', '8309', '8316', '8331', '8354', '8355', '8410', '8411', '8424', '8425', '8439', '8473',
                       '8570', '8572', '8585', '8591', '8593', '8595', '8601', '8604', '8628', '8630', '8697', '8725',
                       '8750', '8766', '8795', '8801', '8802', '8804', '8830', '8850', '8876', '8892', '8905', '8919',
                       '9001', '9005', '9007', '9008', '9009', '9020', '9021', '9022', '9042', '9062', '9064', '9065',
                       '9069', '9086', '9090', '9101', '9104', '9107', '9142', '9143', '9202', '9301', '9375', '9418',
                       '9432', '9433', '9434', '9435', '9501', '9502', '9503', '9504', '9506', '9508', '9509', '9513',
                       '9517', '9519', '9531', '9532', '9602', '9613', '9627', '9678', '9684', '9697', '9719', '9735',
                       '9744', '9766', '9787', '9810', '9843', '9962', '9983', '9984', '9989']
    big_list = []
    f_compare_content_2021_12_28 = []
    get_index()
    js225_400_codes = ['1332', '1333', '1417', '1605', '1719', '1720', '1721', '1766', '1801', '1802', '1803', '1808',
                       '1812', '1820', '1821', '1824', '1860', '1861', '1878', '1881', '1893', '1911', '1925', '1928',
                       '1942', '1951', '1959', '1963', '1973', '2002', '2121', '2127', '2146', '2175', '2181', '2201',
                       '2229', '2264', '2267', '2269', '2281', '2282', '2317', '2327', '2331', '2337', '2371', '2379',
                       '2412', '2413', '2427', '2432', '2433', '2501', '2502', '2503', '2531', '2587', '2593', '2651',
                       '2670', '2702', '2768', '2782', '2784', '2801', '2802', '2809', '2811', '2815', '2871', '2875',
                       '2897', '2914', '3003', '3038', '3048', '3064', '3086', '3088', '3092', '3099', '3101', '3103',
                       '3107', '3116', '3141', '3148', '3167', '3231', '3244', '3254', '3288', '3289', '3291', '3349',
                       '3360', '3382', '3391', '3401', '3402', '3405', '3407', '3436', '3543', '3549', '3563', '3626',
                       '3635', '3659', '3738', '3765', '3769', '3861', '3863', '3880', '3923', '3932', '3941', '4004',
                       '4005', '4021', '4042', '4043', '4061', '4063', '4088', '4091', '4151', '4182', '4183', '4188',
                       '4202', '4204', '4205', '4206', '4208', '4307', '4324', '4348', '4403', '4452', '4502', '4503',
                       '4506', '4507', '4516', '4519', '4521', '4523', '4527', '4528', '4536', '4543', '4552', '4553',
                       '4568', '4578', '4587', '4612', '4613', '4631', '4661', '4684', '4686', '4689', '4704', '4716',
                       '4732', '4739', '4751', '4755', '4768', '4812', '4816', '4819', '4848', '4849', '4887', '4901',
                       '4902', '4911', '4912', '4921', '4922', '4927', '4967', '5019', '5020', '5021', '5101', '5105',
                       '5108', '5110', '5201', '5202', '5214', '5232', '5233', '5301', '5332', '5333', '5334', '5393',
                       '5401', '5406', '5411', '5541', '5631', '5703', '5706', '5707', '5711', '5713', '5714', '5801',
                       '5802', '5803', '5857', '5929', '5947', '6005', '6028', '6035', '6055', '6098', '6103', '6113',
                       '6134', '6136', '6141', '6146', '6178', '6183', '6201', '6235', '6268', '6273', '6301', '6302',
                       '6305', '6326', '6361', '6367', '6383', '6432', '6448', '6465', '6471', '6472', '6473', '6479',
                       '6501', '6503', '6504', '6506', '6532', '6544', '6586', '6594', '6645', '6670', '6674', '6701',
                       '6702', '6703', '6723', '6724', '6727', '6728', '6750', '6752', '6753', '6754', '6758', '6762',
                       '6770', '6841', '6845', '6849', '6856', '6857', '6861', '6869', '6902', '6920', '6923', '6952',
                       '6954', '6965', '6971', '6976', '6981', '6988', '7003', '7004', '7011', '7012', '7013', '7148',
                       '7164', '7167', '7177', '7186', '7201', '7202', '7203', '7205', '7211', '7259', '7261', '7267',
                       '7269', '7270', '7272', '7276', '7282', '7309', '7313', '7419', '7453', '7459', '7516', '7532',
                       '7550', '7564', '7575', '7649', '7701', '7717', '7729', '7731', '7733', '7735', '7741', '7747',
                       '7751', '7752', '7762', '7832', '7846', '7911', '7912', '7947', '7951', '7956', '7974', '7988',
                       '8001', '8002', '8015', '8020', '8031', '8035', '8053', '8056', '8058', '8088', '8111', '8113',
                       '8194', '8233', '8252', '8253', '8267', '8273', '8279', '8282', '8283', '8303', '8304', '8306',
                       '8308', '8309', '8316', '8331', '8354', '8355', '8410', '8411', '8424', '8425', '8439', '8473',
                       '8570', '8572', '8585', '8591', '8593', '8595', '8601', '8604', '8628', '8630', '8697', '8725',
                       '8750', '8766', '8795', '8801', '8802', '8804', '8830', '8850', '8876', '8892', '8905', '8919',
                       '9001', '9005', '9007', '9008', '9009', '9020', '9021', '9022', '9042', '9062', '9064', '9065',
                       '9069', '9086', '9090', '9101', '9104', '9107', '9142', '9143', '9202', '9301', '9375', '9418',
                       '9432', '9433', '9434', '9435', '9501', '9502', '9503', '9504', '9506', '9508', '9509', '9513',
                       '9517', '9519', '9531', '9532', '9602', '9613', '9627', '9678', '9684', '9697', '9719', '9735',
                       '9744', '9766', '9787', '9810', '9843', '9962', '9983', '9984', '9989']






    for it in js225_400_codes:

        url = "https://minkabu.jp/stock/{0}".format(it)
        print(url)
        jsp = JSPool_M(url)# 这里把请求和解析都进行了处理
        jsp.page_parse_()


   #2022.1
    f_compare_content_2022_1_22 =[]
    tablename = "js225_400_leverage_2022_0122"
    _2022_1_22= [27522.26, 17377.93, 533.0, 2383.0, 1822.0, 1051.0, 878.0, 698.0, 2710.0, 9230.0, 3750.0, 928.0, 774.0, 1419.0, 1366.0, 3840.0, 433.0, 899.0, 734.0, 2972.0, 13360.0, 4000.0, 641.0, 2023.0, 3321.0, 2320.0, 862.0, 2378.0, 3395.0, 1106.0, 1800.0, 1579.0, 2203.0, 2172.0, 3465.0, 3435.0, 3020.0, 3620.0, 2679.0, 5410.0, 5920.0, 7030.0, 2516.0, 4360.0, 375.0, 3410.0, 4255.0, 296.0, 2519.0, 3560.0, 3775.0, 4497.0, 1376.0, 1797.0, 1905.0, 2236.0, 4851.0, 1880.0, 1138.0, 4390.0, 6330.0, 4900.0, 5360.0, 5030.0, 1774.0, 2894.0, 1595.0, 8640.0, 3248.0, 2330.0, 3000.0, 6130.0, 2549.0, 4730.0, 7940.0, 2335.0, 1056.0, 3625.0, 1003.0, 2024.0, 1020.0, 3850.0, 2856.0, 904.0, 1271.0, 307.0, 1675.0, 2105.0, 3145.0, 3075.0, 862.0, 2614.0, 2105.0, 2063.0, 5790.0, 648.0, 2524.0, 14920.0, 2566.0, 5240.0, 9630.0, 1458.0, 732.0, 1024.0, 1141.0, 2214.0, 2025.0, 6690.0, 3440.0, 3060.0, 4070.0, 2070.0, 1655.0, 2495.0, 10580.0, 592.0, 1146.0, 1905.0, 2559.0, 2726.0, 865.0, 2366.0, 580.0, 6130.0, 1759.0, 1826.0, 3920.0, 18705.0, 1772.0, 2377.0, 2916.0, 2116.0, 3160.0, 888.0, 850.0, 1901.0, 1324.0, 3195.0, 2059.0, 4375.0, 4215.0, 1972.0, 5270.0, 5853.0, 3323.0, 1933.0, 1324.0, 6941.0, 7350.0, 3680.0, 4235.0, 5934.0, 3165.0, 2700.0, 1289.0, 4274.0, 1993.0, 2722.0, 2609.0, 4153.0, 2228.0, 929.0, 2450.0, 2940.0, 18975.0, 18480.0, 5020.0, 569.0, 5920.0, 8710.0, 1866.0, 3395.0, 1774.0, 1084.0, 4845.0, 3485.0, 8450.0, 4440.0, 2087.0, 2901.0, 4365.0, 7800.0, 518.0, 5936.0, 1531.0, 2939.0, 10790.0, 1741.0, 8690.0, 3140.0, 449.0, 2292.0, 1721.0, 1671.0, 5112.0, 1182.0, 5050.0, 516.0, 2800.0, 3565.0, 2294.0, 1201.0, 4940.0, 1919.0, 1983.0, 2610.0, 1904.0, 561.0, 1496.0, 2316.0, 4015.0, 1793.0, 3195.0, 2481.0, 2036.0, 5214.0, 4945.0, 2330.0, 1560.0, 580.0, 2071.0, 1232.0, 10540.0, 3505.0, 3095.0, 5430.0, 1684.0, 6019.0, 5000.0, 1128.0, 2448.0, 2032.0, 1831.0, 32000.0, 960.0, 1411.0, 8990.0, 2294.0, 3605.0, 65610.0, 2889.0, 2972.0, 2951.0, 2540.0, 5750.0, 24765.0, 8250.0, 2850.0, 2189.0, 8460.0, 779.0, 235.0, 961.0, 2791.0, 6298.0, 1477.0, 5680.0, 4975.0, 44700.0, 1702.0, 4642.0, 11515.0, 9597.0, 1008.0, 2526.0, 5200.0, 18700.0, 897.0, 1313.0, 1986.0, 876.0, 5990.0, 1410.0, 1302.0, 1294.0, 1666.0, 12955.0, 4150.0, 1095.0, 1984.0, 4750.0, 3095.0, 6090.0, 9650.0, 60700.0, 11230.0, 8822.0, 26770.0, 2797.0, 1478.0, 23105.0, 5920.0, 6780.0, 5650.0, 8646.0, 8910.0, 393.0, 778.0, 3051.0, 2267.0, 2312.0, 686.0, 5240.0, 251.0, 854.0, 454.0, 612.0, 1391.0, 2284.0, 944.0, 310.0, 4310.0, 911.0, 3437.0, 4668.0, 2103.0, 2763.0, 6080.0, 2413.0, 26205.0, 1449.0, 2300.0, 1499.0, 2045.0, 3375.0, 1519.0, 2727.0, 5140.0, 1072.0, 6900.0, 4085.0, 3490.0, 4820.0, 1213.0, 2455.0, 11330.0, 15170.0, 2089.0, 2748.0, 1064.0, 484.0, 8203.0, 4045.0, 2172.0, 2797.0, 3735.0, 5240.0, 2352.0, 54710.0, 3665.0, 3675.0, 1146.0, 4825.0, 1261.0, 2853.0, 57510.0, 1748.0, 3105.0, 3823.0, 5720.0, 5950.0, 4781.0, 3055.0, 1085.0, 2195.0, 1260.0, 2501.0, 3115.0, 6580.0, 1098.0, 4100.0, 2059.0, 2547.0, 674.0, 482.0, 4002.0, 4116.0, 705.0, 2135.0, 875.0, 241.0, 1552.0, 7530.0, 3155.0, 5580.0, 3105.0, 1187.0, 319.0, 125.0, 2481.0, 597.0, 5960.0, 721.0, 517.0, 803.0, 5226.0, 2386.0, 3933.0, 2553.0, 6730.0, 1660.0, 2335.0, 1641.0, 1665.0, 3443.0, 2466.0, 2035.0, 758.0, 1632.0, 3635.0, 2717.0, 1525.0, 2095.0, 5280.0, 3125.0, 6762.0, 4930.0, 15060.0, 3310.0, 6910.0, 2368.0, 4655.0, 927.0, 5330.0, 1420.0, 8370.0, 8240.0, 6570.0, 2414.0, 2456.0, 2448.0, 2719.0, 2837.0, 2597.0, 3262.0, 3562.0, 1440.0, 15090.0, 297.0, 1241.0, 1104.0, 963.0, 823.0, 859.0, 508.0, 1501.0, 1606.0, 1673.0, 2219.0, 1943.0, 4610.0, 2272.0, 5770.0, 2302.0, 5710.0, 2605.0, 2028.0, 7846.0, 6580.0, 5970.0, 3065.0, 5080.0, 16500.0, 3865.0, 67390.0, 5487.0, 2919.0]
    compare_insertDB(big_list,f_compare_content_2022_1_22,_2022_1_22,tablename)


#2022.2
    f_compare_content_2022_2_11 =[]
    tablename = "js225_400_leverage_2022_0211"
    _2022_2_11= [27696.08, 17664.01, 553.0, 2660.0, 1904.0, 1143.0, 869.0, 721.0, 2685.0, 9250.0, 3770.0, 976.0, 790.0, 1473.0, 1462.0, 3780.0, 439.0, 899.0, 760.0, 2941.0, 13480.0, 3985.0, 658.0, 2089.0, 3421.0, 2365.0, 863.0, 2346.0, 3135.0, 1155.0, 1841.0, 1675.0, 2297.0, 1883.0, 3650.0, 3490.0, 3125.0, 3665.0, 2486.0, 5680.0, 5940.0, 6880.0, 2403.0, 4390.0, 378.0, 3770.0, 4190.0, 274.0, 2637.0, 3695.0, 3055.0, 4393.0, 1426.0, 1702.0, 1589.0, 2260.0, 4869.0, 1903.0, 1140.0, 4625.0, 6620.0, 4930.0, 5160.0, 4945.0, 1936.0, 2979.0, 1759.0, 9070.0, 3256.0, 2419.0, 2935.0, 5630.0, 2660.0, 4880.0, 8940.0, 2357.0, 1095.0, 3740.0, 1028.0, 1987.0, 1107.0, 4035.0, 3210.0, 950.0, 1289.0, 319.0, 1759.0, 2233.0, 3140.0, 3175.0, 905.0, 2771.0, 2173.0, 2073.0, 5790.0, 662.0, 2454.0, 14970.0, 2369.0, 5691.0, 9090.0, 1423.0, 689.0, 1094.0, 1144.0, 2168.0, 2161.0, 6910.0, 3615.0, 2759.0, 4185.0, 2442.0, 1698.0, 2497.0, 10350.0, 615.0, 1152.0, 1829.0, 2393.0, 2927.0, 850.0, 2470.0, 582.0, 6540.0, 1882.0, 1912.0, 3660.0, 19115.0, 1729.0, 2309.0, 2972.0, 2093.0, 3055.0, 850.0, 890.0, 2001.0, 1363.0, 3210.0, 2167.0, 4170.0, 4380.0, 2063.0, 5250.0, 5243.0, 3520.0, 2029.0, 1262.0, 7867.0, 7770.0, 4071.0, 4195.0, 5965.0, 3250.0, 2854.0, 1334.0, 3989.0, 2133.0, 2909.0, 2427.0, 4082.0, 2056.0, 894.0, 2341.0, 2762.0, 22235.0, 19230.0, 5580.0, 594.0, 6150.0, 8540.0, 1938.0, 3040.0, 1537.0, 1006.0, 4395.0, 3755.0, 10390.0, 3945.0, 2303.0, 3075.0, 4600.0, 7917.0, 509.0, 6453.0, 1525.0, 3195.0, 11880.0, 1861.0, 9660.0, 3025.0, 459.0, 2339.0, 1730.0, 1640.0, 5258.0, 1162.0, 5630.0, 506.0, 2879.0, 3485.0, 2272.0, 1251.0, 5000.0, 1889.0, 2209.0, 2657.0, 2073.0, 602.0, 1714.0, 3170.0, 3720.0, 1826.0, 3385.0, 2488.0, 2099.0, 5558.0, 5160.0, 2362.0, 1614.0, 679.0, 2246.0, 1245.0, 9870.0, 3360.0, 3575.0, 5200.0, 1674.0, 5870.0, 4945.0, 1114.0, 2672.0, 2017.0, 1741.0, 34350.0, 1018.0, 1408.0, 9350.0, 2322.0, 3640.0, 65750.0, 2876.0, 2974.0, 3085.0, 2417.0, 5870.0, 22450.0, 8920.0, 2780.0, 2216.0, 8780.0, 749.0, 236.0, 1054.0, 2705.0, 6074.0, 1440.0, 6090.0, 4885.0, 44850.0, 1671.0, 4057.0, 10290.0, 8325.0, 998.0, 2440.0, 5300.0, 16560.0, 898.0, 1434.0, 1855.0, 878.0, 6080.0, 1499.0, 1233.0, 1345.0, 1624.0, 12855.0, 4675.0, 1299.0, 1883.0, 4360.0, 3110.0, 6130.0, 9600.0, 60360.0, 10830.0, 8557.0, 22850.0, 2763.0, 1446.0, 23100.0, 6010.0, 6926.0, 5340.0, 8405.0, 8760.0, 361.0, 789.0, 3286.0, 2215.0, 2697.0, 877.0, 4890.0, 280.0, 830.0, 499.0, 635.0, 1509.0, 2254.0, 1082.0, 327.0, 4500.0, 908.0, 3613.0, 4934.0, 2010.0, 2767.0, 5930.0, 2326.0, 29770.0, 1585.0, 2510.0, 1745.0, 2140.0, 3615.0, 1700.0, 2768.0, 5110.0, 1054.0, 6510.0, 4265.0, 3540.0, 4860.0, 1322.0, 2290.0, 11650.0, 15930.0, 1939.0, 2853.0, 1051.0, 499.0, 8217.0, 4330.0, 2288.0, 2789.0, 3370.0, 5710.0, 2275.0, 58060.0, 3595.0, 3867.0, 1217.0, 5010.0, 1362.0, 3033.0, 57150.0, 1883.0, 3215.0, 4049.0, 5280.0, 6300.0, 4462.0, 3060.0, 1151.0, 2301.0, 1370.0, 2634.0, 3245.0, 6640.0, 1258.0, 4470.0, 2298.0, 2728.0, 746.0, 547.0, 4233.0, 4369.0, 785.0, 2407.0, 913.0, 253.0, 1648.0, 7980.0, 3330.0, 6010.0, 3150.0, 1302.0, 330.0, 129.0, 2443.0, 622.0, 1718.0, 703.0, 545.0, 822.0, 5586.0, 2324.0, 4142.0, 2708.0, 7103.0, 1779.0, 2564.0, 1711.0, 1717.0, 3666.0, 2531.0, 2125.0, 762.0, 1673.0, 3545.0, 2927.0, 1635.0, 2154.0, 5430.0, 3400.0, 7185.0, 5140.0, 15780.0, 3550.0, 6910.0, 2185.0, 4185.0, 933.0, 5900.0, 1148.0, 9760.0, 9140.0, 7340.0, 2571.0, 2508.0, 2643.0, 2795.0, 3120.0, 2591.0, 3297.0, 3769.0, 1451.0, 14710.0, 365.0, 1145.0, 1124.0, 900.0, 745.0, 846.0, 511.0, 1874.0, 1475.0, 1498.0, 2329.0, 2094.0, 4850.0, 2280.0, 6150.0, 2308.0, 5830.0, 2835.0, 1992.0, 8442.0, 6980.0, 6890.0, 3045.0, 5400.0, 16680.0, 3575.0, 64310.0, 5483.0, 3020.0]
    compare_insertDB(big_list,f_compare_content_2022_2_11,_2022_2_11,tablename)

    # 2022.3

    f_compare_content_2022_3_21 =[]
    tablename = "js225_400_leverage_2022_0321"
    _2022_3_21= [26827.43, 17213.33, 565.0, 2490.0, 2003.0, 1321.0, 860.0, 693.0, 2708.0, 8900.0, 3640.0, 914.0, 754.0, 1484.0, 1542.0, 3850.0, 421.0, 899.0, 750.0, 2865.0, 12880.0, 3985.0, 608.0, 2203.0, 3224.0, 2433.0, 860.0, 2331.0, 2975.0, 1513.0, 1762.0, 1766.0, 2193.0, 1559.0, 2818.0, 3465.0, 2462.0, 3880.0, 2493.0, 5390.0, 6530.0, 6750.0, 2283.0, 4190.0, 447.0, 3545.0, 4305.0, 304.0, 2810.0, 3260.0, 2598.0, 4251.0, 1229.0, 1835.0, 1550.0, 2321.0, 4329.0, 1823.0, 1134.0, 4645.0, 6360.0, 4880.0, 4735.0, 5080.0, 1994.0, 2740.0, 1767.0, 8630.0, 3481.0, 2463.0, 3135.0, 5380.0, 2478.0, 4600.0, 8810.0, 2032.0, 1085.0, 3940.0, 1065.0, 2600.0, 986.0, 4385.0, 3230.0, 927.0, 1096.0, 289.0, 1710.0, 1949.0, 3040.0, 3230.0, 897.0, 2942.0, 2226.0, 2000.0, 5400.0, 663.0, 2155.0, 15720.0, 2102.0, 5522.0, 8490.0, 1377.0, 631.0, 1033.0, 1084.0, 1901.0, 2066.0, 7260.0, 3475.0, 2822.0, 4250.0, 2805.0, 1689.0, 2560.0, 11190.0, 587.0, 1065.0, 1651.0, 1612.0, 2825.0, 808.0, 2314.0, 555.0, 6890.0, 1819.0, 1727.0, 3490.0, 18320.0, 1719.0, 2300.0, 2967.0, 2103.0, 3030.0, 802.0, 821.0, 1814.0, 1316.0, 3065.0, 2020.0, 4340.0, 4725.0, 2114.0, 5010.0, 4930.0, 3594.0, 1910.0, 1241.0, 7472.0, 8400.0, 4025.0, 3935.0, 5858.0, 3755.0, 3027.0, 1323.0, 3720.0, 2144.0, 2870.0, 2411.0, 4166.0, 2035.0, 1073.0, 2113.0, 2444.0, 22985.0, 18050.0, 5320.0, 528.0, 7000.0, 8980.0, 2033.0, 2978.0, 1496.0, 953.0, 4230.0, 3725.0, 10210.0, 4265.0, 2461.0, 2754.0, 4475.0, 7252.0, 520.0, 5963.0, 1427.0, 2980.0, 12390.0, 1645.0, 10010.0, 3295.0, 458.0, 2567.0, 1589.0, 1512.0, 4502.0, 1073.0, 4825.0, 440.0, 2734.0, 3415.0, 2071.0, 1101.0, 4940.0, 1715.0, 1947.0, 2453.0, 2158.0, 599.0, 1754.0, 3750.0, 3570.0, 1764.0, 3465.0, 2940.0, 2192.0, 5994.0, 5730.0, 2186.0, 1428.0, 573.0, 2270.0, 1221.0, 9410.0, 3110.0, 3335.0, 4195.0, 1726.0, 5313.0, 4930.0, 1047.0, 2243.0, 1890.0, 1584.0, 31900.0, 958.0, 1351.0, 8220.0, 2010.0, 3110.0, 67140.0, 2871.0, 2850.0, 3050.0, 2196.0, 6550.0, 22360.0, 8350.0, 2585.0, 2205.0, 8420.0, 716.0, 199.0, 920.0, 2496.0, 5829.0, 1387.0, 5870.0, 4730.0, 43500.0, 1671.0, 4058.0, 9698.0, 8077.0, 945.0, 2347.0, 5090.0, 17500.0, 859.0, 1310.0, 1805.0, 926.0, 6030.0, 1532.0, 1174.0, 1127.0, 1531.0, 12425.0, 3995.0, 1089.0, 2080.0, 4200.0, 3105.0, 6400.0, 8910.0, 54800.0, 8693.0, 7446.0, 19160.0, 2435.0, 1406.0, 20870.0, 5950.0, 6597.0, 5320.0, 7917.0, 8560.0, 364.0, 742.0, 3669.0, 2121.0, 2803.0, 751.0, 4690.0, 260.0, 807.0, 466.0, 505.0, 1580.0, 2020.0, 721.0, 285.0, 4005.0, 849.0, 3342.0, 4062.0, 1830.0, 2495.0, 5020.0, 1963.0, 27310.0, 1374.0, 2366.0, 1532.0, 2122.0, 3620.0, 1822.0, 2792.0, 5190.0, 1071.0, 6180.0, 4045.0, 3350.0, 4805.0, 1241.0, 2202.0, 11360.0, 13800.0, 2335.0, 2837.0, 1033.0, 493.0, 8928.0, 5260.0, 2239.0, 2968.0, 3085.0, 5190.0, 2058.0, 60940.0, 2882.0, 3980.0, 1371.0, 4770.0, 1368.0, 3134.0, 58360.0, 2046.0, 3120.0, 4296.0, 5310.0, 6100.0, 4303.0, 3150.0, 1119.0, 2193.0, 1287.0, 2654.0, 3145.0, 6680.0, 1255.0, 4800.0, 2282.0, 2584.0, 761.0, 530.0, 4038.0, 4069.0, 752.0, 2364.0, 880.0, 250.0, 1602.0, 7060.0, 2997.0, 4550.0, 3120.0, 1166.0, 307.0, 123.0, 2333.0, 569.0, 1913.0, 715.0, 516.0, 844.0, 5425.0, 2251.0, 4063.0, 2511.0, 7093.0, 1652.0, 2669.0, 1773.0, 1801.0, 3418.0, 2497.0, 1783.0, 780.0, 1623.0, 3270.0, 2930.0, 1652.0, 2014.0, 4740.0, 3405.0, 6987.0, 5138.0, 16205.0, 3565.0, 6910.0, 2314.0, 3985.0, 946.0, 6770.0, 1044.0, 12400.0, 11470.0, 8810.0, 2602.0, 2377.0, 2507.0, 2876.0, 3435.0, 2368.0, 3486.0, 4012.0, 1500.0, 13770.0, 374.0, 1222.0, 1197.0, 897.0, 745.0, 861.0, 488.0, 1853.0, 1907.0, 1860.0, 2252.0, 2116.0, 4805.0, 2284.0, 6240.0, 2026.0, 5560.0, 2916.0, 2126.0, 8728.0, 6620.0, 7070.0, 3115.0, 5330.0, 16920.0, 3780.0, 60210.0, 4961.0, 3050.0]
    compare_insertDB(big_list,f_compare_content_2022_3_21,_2022_3_21,tablename)

# 2022.5
    f_compare_content_2022_5_3 =[]
    tablename = "js225_400_leverage_2022_0503"
    _2022_5_3=[26818.53, 17106.32, 572.0, 2377.0, 1819.0, 1524.0, 906.0, 610.0, 2664.0, 8530.0, 3510.0, 894.0, 682.0, 1409.0, 1440.0, 3805.0, 423.0, 899.0, 748.0, 2709.0, 11830.0, 4000.0, 625.0, 1960.0, 3123.0, 2231.0, 812.0, 2158.0, 2853.0, 1449.0, 1814.0, 1722.0, 2245.0, 1402.0, 2889.0, 3255.0, 2553.0, 4045.0, 2325.0, 5160.0, 6650.0, 6530.0, 2124.0, 4075.0, 413.0, 3660.0, 3630.0, 287.0, 2756.0, 4310.0, 1998.0, 4241.0, 1273.0, 1905.0, 1556.0, 2717.0, 4824.0, 1915.0, 1086.0, 5070.0, 5410.0, 4790.0, 5320.0, 5170.0, 1981.0, 2579.0, 1815.0, 7320.0, 3278.0, 2188.0, 3275.0, 5270.0, 2365.0, 4000.0, 9060.0, 2228.0, 1082.0, 3080.0, 1094.0, 2273.0, 1000.0, 4205.0, 2836.0, 984.0, 1082.0, 280.0, 1684.0, 2054.0, 2644.0, 2944.0, 876.0, 3105.0, 2086.0, 1556.0, 5000.0, 675.0, 2095.0, 11880.0, 2195.0, 5808.0, 6650.0, 1380.0, 625.0, 1046.0, 1079.0, 1890.0, 2213.0, 5630.0, 2991.0, 2953.0, 4120.0, 2939.0, 1671.0, 2668.0, 10760.0, 619.0, 1034.0, 1554.0, 1499.0, 3065.0, 776.0, 2504.0, 557.0, 6920.0, 1811.0, 1747.0, 3480.0, 17895.0, 1695.0, 2289.0, 2762.0, 1932.0, 2998.0, 795.0, 785.0, 1739.0, 1353.0, 2976.0, 2032.0, 3695.0, 4840.0, 2179.0, 4790.0, 5276.0, 3771.0, 1960.0, 1173.0, 7228.0, 8880.0, 3871.0, 3950.0, 5735.0, 3440.0, 3382.0, 1079.0, 3902.0, 2424.0, 2842.0, 3296.0, 4423.0, 2036.0, 1026.0, 1789.0, 2486.0, 19455.0, 19110.0, 5590.0, 464.0, 7340.0, 8460.0, 2162.0, 2983.0, 1423.0, 918.0, 4250.0, 3925.0, 10080.0, 4345.0, 2433.0, 3130.0, 4225.0, 7205.0, 465.0, 6063.0, 1353.0, 2490.0, 13730.0, 1530.0, 9090.0, 3440.0, 460.0, 3220.0, 1740.0, 1494.0, 4824.0, 1133.0, 4880.0, 397.0, 2670.0, 3570.0, 2120.0, 1077.0, 4410.0, 1764.0, 2301.0, 2316.0, 2070.0, 569.0, 1594.0, 3705.0, 3625.0, 1662.0, 3250.0, 2831.0, 2044.0, 5701.0, 5490.0, 2135.0, 1417.0, 638.0, 2069.0, 1182.0, 8280.0, 2720.0, 3305.0, 4080.0, 1897.0, 4776.0, 4705.0, 1022.0, 2149.0, 1631.0, 1652.0, 31050.0, 905.0, 1496.0, 7930.0, 1860.0, 2958.0, 62890.0, 2976.0, 2755.0, 3020.0, 2242.0, 6030.0, 19480.0, 8090.0, 2419.0, 2282.0, 8130.0, 724.0, 210.0, 920.0, 2524.0, 6480.0, 1355.0, 5660.0, 4415.0, 42850.0, 1727.0, 3752.0, 8427.0, 7666.0, 851.0, 2261.0, 5330.0, 19625.0, 847.0, 1389.0, 1894.0, 929.0, 5130.0, 1525.0, 1153.0, 1090.0, 1528.0, 11160.0, 4080.0, 1313.0, 2071.0, 3895.0, 3150.0, 6370.0, 8560.0, 52240.0, 8350.0, 7792.0, 18330.0, 2218.0, 1363.0, 19710.0, 5800.0, 6765.0, 5360.0, 8202.0, 8700.0, 350.0, 702.0, 4437.0, 2302.0, 2970.0, 787.0, 4605.0, 261.0, 804.0, 473.0, 514.0, 1513.0, 2228.0, 677.0, 327.0, 3730.0, 940.0, 3432.0, 4000.0, 1995.0, 2717.0, 4695.0, 1886.0, 23450.0, 1374.0, 2629.0, 1187.0, 2177.0, 3695.0, 2021.0, 3040.0, 4570.0, 1085.0, 5510.0, 4330.0, 3035.0, 4440.0, 1461.0, 2327.0, 10660.0, 12730.0, 2475.0, 2987.0, 976.0, 492.0, 8765.0, 5260.0, 2163.0, 2739.0, 2756.0, 5070.0, 2192.0, 58500.0, 2747.0, 3916.0, 1426.0, 4555.0, 1342.0, 3192.0, 54790.0, 2057.0, 3240.0, 4397.0, 5190.0, 6470.0, 4512.0, 2931.0, 1203.0, 2286.0, 1516.0, 2465.0, 2828.0, 6820.0, 1301.0, 4730.0, 2236.0, 2590.0, 756.0, 545.0, 4008.0, 3870.0, 743.0, 2354.0, 843.0, 244.0, 1567.0, 7020.0, 3035.0, 4070.0, 2907.0, 1209.0, 343.0, 126.0, 2356.0, 585.0, 1547.0, 635.0, 500.0, 806.0, 5242.0, 1982.0, 3881.0, 2626.0, 6938.0, 1695.0, 2726.0, 1870.0, 1820.0, 3423.0, 2393.0, 1876.0, 761.0, 1565.0, 2971.0, 2946.0, 1620.0, 2000.0, 4955.0, 3340.0, 6841.0, 4870.0, 16630.0, 3475.0, 6910.0, 2460.0, 3955.0, 890.0, 8460.0, 1501.0, 9790.0, 3255.0, 7200.0, 2582.0, 2345.0, 2519.0, 3115.0, 3140.0, 2149.0, 3836.0, 4324.0, 1499.0, 15110.0, 456.0, 1308.0, 1165.0, 841.0, 727.0, 828.0, 486.0, 1797.0, 1989.0, 1638.0, 2428.0, 2302.0, 4900.0, 2431.0, 5800.0, 1943.0, 5230.0, 3420.0, 2076.0, 9072.0, 6980.0, 8150.0, 2789.0, 5300.0, 13075.0, 3240.0, 60700.0, 5290.0, 2987.0]
    compare_insertDB(big_list,f_compare_content_2022_5_3,_2022_5_3,tablename)










 #   create table js225_400_leverage_2022_0503(id int not null primary key auto_increment,J225 text,J400 text,J1332 text, J1333 text, J1417 text, J1605 text, J1719 text, J1720 text, J1721 text, J1766 text, J1801 text, J1802 text, J1803 text, J1808 text, J1812 text, J1820 text, J1821 text, J1824 text, J1860 text, J1861 text, J1878 text, J1881 text, J1893 text, J1911 text, J1925 text, J1928 text, J1942 text, J1951 text, J1959 text, J1963 text, J1973 text, J2002 text, J2121 text, J2127 text, J2146 text, J2175 text, J2181 text, J2201 text, J2229 text, J2264 text, J2267 text, J2269 text, J2281 text, J2282 text, J2317 text, J2327 text, J2331 text, J2337 text, J2371 text, J2379 text, J2412 text, J2413 text, J2427 text, J2432 text, J2433 text, J2501 text, J2502 text, J2503 text, J2531 text, J2587 text, J2593 text, J2651 text, J2670 text, J2702 text, J2768 text, J2782 text, J2784 text, J2801 text, J2802 text, J2809 text, J2811 text, J2815 text, J2871 text, J2875 text, J2897 text, J2914 text, J3003 text, J3038 text, J3048 text, J3064 text, J3086 text, J3088 text, J3092 text, J3099 text, J3101 text, J3103 text, J3107 text, J3116 text, J3141 text, J3148 text, J3167 text, J3231 text, J3244 text, J3254 text, J3288 text, J3289 text, J3291 text, J3349 text, J3360 text, J3382 text, J3391 text, J3401 text, J3402 text, J3405 text, J3407 text, J3436 text, J3543 text, J3549 text, J3563 text, J3626 text, J3635 text, J3659 text, J3738 text, J3765 text, J3769 text, J3861 text, J3863 text, J3880 text, J3923 text, J3932 text, J3941 text, J4004 text, J4005 text, J4021 text, J4042 text, J4043 text, J4061 text, J4063 text, J4088 text, J4091 text, J4151 text, J4182 text, J4183 text, J4188 text, J4202 text, J4204 text, J4205 text, J4206 text, J4208 text, J4307 text, J4324 text, J4348 text, J4403 text, J4452 text, J4502 text, J4503 text, J4506 text, J4507 text, J4516 text, J4519 text, J4521 text, J4523 text, J4527 text, J4528 text, J4536 text, J4543 text, J4552 text, J4553 text, J4568 text, J4578 text, J4587 text, J4612 text, J4613 text, J4631 text, J4661 text, J4684 text, J4686 text, J4689 text, J4704 text, J4716 text, J4732 text, J4739 text, J4751 text, J4755 text, J4768 text, J4812 text, J4816 text, J4819 text, J4848 text, J4849 text, J4887 text, J4901 text, J4902 text, J4911 text, J4912 text, J4921 text, J4922 text, J4927 text, J4967 text, J5019 text, J5020 text, J5021 text, J5101 text, J5105 text, J5108 text, J5110 text, J5201 text, J5202 text, J5214 text, J5232 text, J5233 text, J5301 text, J5332 text, J5333 text, J5334 text, J5393 text, J5401 text, J5406 text, J5411 text, J5541 text, J5631 text, J5703 text, J5706 text, J5707 text, J5711 text, J5713 text, J5714 text, J5801 text, J5802 text, J5803 text, J5857 text, J5929 text, J5947 text, J6005 text, J6028 text, J6035 text, J6055 text, J6098 text, J6103 text, J6113 text, J6134 text, J6136 text, J6141 text, J6146 text, J6178 text, J6183 text, J6201 text, J6235 text, J6268 text, J6273 text, J6301 text, J6302 text, J6305 text, J6326 text, J6361 text, J6367 text, J6383 text, J6432 text, J6448 text, J6465 text, J6471 text, J6472 text, J6473 text, J6479 text, J6501 text, J6503 text, J6504 text, J6506 text, J6532 text, J6544 text, J6586 text, J6594 text, J6645 text, J6670 text, J6674 text, J6701 text, J6702 text, J6703 text, J6723 text, J6724 text, J6727 text, J6728 text, J6750 text, J6752 text, J6753 text, J6754 text, J6758 text, J6762 text, J6770 text, J6841 text, J6845 text, J6849 text, J6856 text, J6857 text, J6861 text, J6869 text, J6902 text, J6920 text, J6923 text, J6952 text, J6954 text, J6965 text, J6971 text, J6976 text, J6981 text, J6988 text, J7003 text, J7004 text, J7011 text, J7012 text, J7013 text, J7148 text, J7164 text, J7167 text, J7177 text, J7186 text, J7201 text, J7202 text, J7203 text, J7205 text, J7211 text, J7259 text, J7261 text, J7267 text, J7269 text, J7270 text, J7272 text, J7276 text, J7282 text, J7309 text, J7313 text, J7419 text, J7453 text, J7459 text, J7516 text, J7532 text, J7550 text, J7564 text, J7575 text, J7649 text, J7701 text, J7717 text, J7729 text, J7731 text, J7733 text, J7735 text, J7741 text, J7747 text, J7751 text, J7752 text, J7762 text, J7832 text, J7846 text, J7911 text, J7912 text, J7947 text, J7951 text, J7956 text, J7974 text, J7988 text, J8001 text, J8002 text, J8015 text, J8020 text, J8031 text, J8035 text, J8053 text, J8056 text, J8058 text, J8088 text, J8111 text, J8113 text, J8194 text, J8233 text, J8252 text, J8253 text, J8267 text, J8273 text, J8279 text, J8282 text, J8283 text, J8303 text, J8304 text, J8306 text, J8308 text, J8309 text, J8316 text, J8331 text, J8354 text, J8355 text, J8410 text, J8411 text, J8424 text, J8425 text, J8439 text, J8473 text, J8570 text, J8572 text, J8585 text, J8591 text, J8593 text, J8595 text, J8601 text, J8604 text, J8628 text, J8630 text, J8697 text, J8725 text, J8750 text, J8766 text, J8795 text, J8801 text, J8802 text, J8804 text, J8830 text, J8850 text, J8876 text, J8892 text, J8905 text, J8919 text, J9001 text, J9005 text, J9007 text, J9008 text, J9009 text, J9020 text, J9021 text, J9022 text, J9042 text, J9062 text, J9064 text, J9065 text, J9069 text, J9086 text, J9090 text, J9101 text, J9104 text, J9107 text, J9142 text, J9143 text, J9202 text, J9301 text, J9375 text, J9418 text, J9432 text, J9433 text, J9434 text, J9435 text, J9501 text, J9502 text, J9503 text, J9504 text, J9506 text, J9508 text, J9509 text, J9513 text, J9517 text, J9519 text, J9531 text, J9532 text, J9602 text, J9613 text, J9627 text, J9678 text, J9684 text, J9697 text, J9719 text, J9735 text, J9744 text, J9766 text, J9787 text, J9810 text, J9843 text, J9962 text, J9983 text, J9984 text, J9989 text,LastTime timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP ) engine=InnoDB  charset=utf8;




